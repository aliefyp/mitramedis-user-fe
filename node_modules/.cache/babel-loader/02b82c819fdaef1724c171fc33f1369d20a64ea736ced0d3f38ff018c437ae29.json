{"ast":null,"code":"import _objectSpread from\"/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{TbSearch}from\"react-icons/tb\";import{useForm}from\"react-hook-form\";import Card from\"components/Card\";import Button from\"components/Button\";import Input from\"components/FormInput/Input\";import ComboBox from\"components/FormInput/ComboBox\";import{useMemo,useState}from\"react\";import{useAllStock}from\"api/stock\";import{useLocation}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StockCardFilter=function StockCardFilter(_ref){var _errors$item_name,_errors$stock_id,_errors$period_month;var onSubmit=_ref.onSubmit;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchText=_useState2[0],setSearchText=_useState2[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors;var submitForm=function submitForm(val){onSubmit(val);};var location=useLocation();var filter=Object.fromEntries(new URLSearchParams(location.search));var _useAllStock=useAllStock({filter:filter}),dataStock=_useAllStock.data,loadingStock=_useAllStock.isLoading,stockPage=_useAllStock.page,setStockPage=_useAllStock.setPage;var stockList=useMemo(function(){var _dataStock$data,_dataStock$data$data,_dataStock$data2,_dataStock$data2$data,_dataStock$data2$data2;if(!(dataStock!==null&&dataStock!==void 0&&(_dataStock$data=dataStock.data)!==null&&_dataStock$data!==void 0&&(_dataStock$data$data=_dataStock$data.data)!==null&&_dataStock$data$data!==void 0&&_dataStock$data$data.stock))return[];return dataStock===null||dataStock===void 0?void 0:(_dataStock$data2=dataStock.data)===null||_dataStock$data2===void 0?void 0:(_dataStock$data2$data=_dataStock$data2.data)===null||_dataStock$data2$data===void 0?void 0:(_dataStock$data2$data2=_dataStock$data2$data.stock)===null||_dataStock$data2$data2===void 0?void 0:_dataStock$data2$data2.map(function(item){return{key:item.stock_id,label:item.item_name,unit:item.unit};});},[dataStock]);var displayedStockList=useMemo(function(){if(!(stockList!==null&&stockList!==void 0&&stockList.length))return[];var copyIcd=_toConsumableArray(stockList);var filtered=searchText===\"\"?copyIcd:copyIcd.filter(function(val){return val.label.toLowerCase().replace(/\\s+/g,\"\").includes(searchText.toLowerCase().replace(/\\s+/g,\"\"));});return filtered.splice(0,10*stockPage);},[stockList,stockPage,searchText]);return/*#__PURE__*/_jsx(Card,{className:\"rounded-2xl border-none p-3 shadow-sm\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit(submitForm),children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 items-center gap-4\",children:[/*#__PURE__*/_jsx(ComboBox,_objectSpread({required:true,type:\"text\",loading:loadingStock,options:displayedStockList,placeholder:\"Nama Item\",className:\"col-span-3 md:col-span-2\",error:Boolean(errors===null||errors===void 0?void 0:errors.item_name),helper:errors===null||errors===void 0?void 0:(_errors$item_name=errors.item_name)===null||_errors$item_name===void 0?void 0:_errors$item_name.message,onValueChange:function onValueChange(val){setValue(\"item_name\",val.label);setValue(\"stock_id\",String(val.key));},onSearch:function onSearch(val){return setSearchText(val);},onLoadMore:function onLoadMore(){return setStockPage(stockPage+1);}},register(\"item_name\",{required:{value:true,message:\"Wajib diisi\"}}))),/*#__PURE__*/_jsx(Input,_objectSpread({required:true,readOnly:true,disabled:true,type:\"text\",placeholder:\"Kode Item KFA / Barcode\",className:\"col-span-3 md:col-span-1\",error:Boolean(errors===null||errors===void 0?void 0:errors.stock_id),helper:errors===null||errors===void 0?void 0:(_errors$stock_id=errors.stock_id)===null||_errors$stock_id===void 0?void 0:_errors$stock_id.message},register(\"stock_id\",{required:{value:true,message:\"Wajib diisi\"}}))),/*#__PURE__*/_jsx(Input,_objectSpread({required:true,type:\"month\",placeholder:\"Bulan\",className:\"col-span-3 md:col-span-1\",error:Boolean(errors===null||errors===void 0?void 0:errors.period_month),helper:errors===null||errors===void 0?void 0:(_errors$period_month=errors.period_month)===null||_errors$period_month===void 0?void 0:_errors$period_month.message},register(\"period_month\",{required:{value:true,message:\"Wajib diisi\"}}))),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-3 flex h-full items-end justify-end gap-2 sm:col-span-2\",children:[/*#__PURE__*/_jsx(Button,{type:\"reset\",color:\"ghost-primary\",children:\"Reset\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",color:\"secondary\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(TbSearch,{}),\"Cari\"]})})]})]})})});};export default StockCardFilter;","map":{"version":3,"names":["TbSearch","useForm","Card","Button","Input","ComboBox","useMemo","useState","useAllStock","useLocation","jsx","_jsx","jsxs","_jsxs","StockCardFilter","_ref","_errors$item_name","_errors$stock_id","_errors$period_month","onSubmit","_useState","_useState2","_slicedToArray","searchText","setSearchText","_useForm","register","handleSubmit","setValue","errors","formState","submitForm","val","location","filter","Object","fromEntries","URLSearchParams","search","_useAllStock","dataStock","data","loadingStock","isLoading","stockPage","page","setStockPage","setPage","stockList","_dataStock$data","_dataStock$data$data","_dataStock$data2","_dataStock$data2$data","_dataStock$data2$data2","stock","map","item","key","stock_id","label","item_name","unit","displayedStockList","length","copyIcd","_toConsumableArray","filtered","toLowerCase","replace","includes","splice","className","children","_objectSpread","required","type","loading","options","placeholder","error","Boolean","helper","message","onValueChange","String","onSearch","onLoadMore","value","readOnly","disabled","period_month","color"],"sources":["/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/src/pages/StockCard/components/StockCardFilter.tsx"],"sourcesContent":["import { TbSearch } from \"react-icons/tb\";\nimport { useForm } from \"react-hook-form\";\nimport Card from \"components/Card\";\nimport Button from \"components/Button\";\nimport Input from \"components/FormInput/Input\";\nimport ComboBox from \"components/FormInput/ComboBox\";\nimport { useMemo, useState } from \"react\";\nimport { useAllStock } from \"api/stock\";\nimport { useLocation } from \"react-router-dom\";\n\ninterface StockCardType {\n  item_name: string;\n  stock_id: string;\n  period_month: string;\n}\n\ninterface StockCardFilterProps {\n  onSubmit: (val: StockCardType) => void;\n}\n\nconst StockCardFilter = ({ onSubmit }: StockCardFilterProps) => {\n  const [searchText, setSearchText] = useState(\"\");\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n  } = useForm<StockCardType>();\n\n  const submitForm = (val: StockCardType) => {\n    onSubmit(val);\n  };\n\n  const location = useLocation();\n  const filter = Object.fromEntries(new URLSearchParams(location.search));\n\n  const {\n    data: dataStock,\n    isLoading: loadingStock,\n    page: stockPage,\n    setPage: setStockPage,\n  } = useAllStock({ filter });\n\n  const stockList = useMemo(() => {\n    if (!dataStock?.data?.data?.stock) return [];\n\n    return dataStock?.data?.data?.stock?.map((item) => ({\n      key: item.stock_id,\n      label: item.item_name,\n      unit: item.unit,\n    }));\n  }, [dataStock]);\n\n  const displayedStockList = useMemo(() => {\n    if (!stockList?.length) return [];\n\n    const copyIcd = [...stockList];\n    const filtered =\n      searchText === \"\"\n        ? copyIcd\n        : copyIcd.filter((val) =>\n            val.label\n              .toLowerCase()\n              .replace(/\\s+/g, \"\")\n              .includes(searchText.toLowerCase().replace(/\\s+/g, \"\"))\n          );\n\n    return filtered.splice(0, 10 * stockPage);\n  }, [stockList, stockPage, searchText]);\n\n  return (\n    <Card className=\"rounded-2xl border-none p-3 shadow-sm\">\n      <form onSubmit={handleSubmit(submitForm)}>\n        <div className=\"grid grid-cols-3 items-center gap-4\">\n          <ComboBox\n            required\n            type=\"text\"\n            loading={loadingStock}\n            options={displayedStockList}\n            placeholder=\"Nama Item\"\n            className=\"col-span-3 md:col-span-2\"\n            error={Boolean(errors?.item_name)}\n            helper={errors?.item_name?.message}\n            onValueChange={(val) => {\n              setValue(\"item_name\", val.label);\n              setValue(\"stock_id\", String(val.key));\n            }}\n            onSearch={(val) => setSearchText(val)}\n            onLoadMore={() => setStockPage(stockPage + 1)}\n            {...register(\"item_name\", {\n              required: {\n                value: true,\n                message: \"Wajib diisi\",\n              },\n            })}\n          />\n\n          {/* code */}\n          <Input\n            required\n            readOnly\n            disabled\n            type=\"text\"\n            placeholder=\"Kode Item KFA / Barcode\"\n            className=\"col-span-3 md:col-span-1\"\n            error={Boolean(errors?.stock_id)}\n            helper={errors?.stock_id?.message}\n            {...register(\"stock_id\", {\n              required: {\n                value: true,\n                message: \"Wajib diisi\",\n              },\n            })}\n          />\n\n          {/* period_month */}\n          <Input\n            required\n            type=\"month\"\n            placeholder=\"Bulan\"\n            className=\"col-span-3 md:col-span-1\"\n            error={Boolean(errors?.period_month)}\n            helper={errors?.period_month?.message}\n            {...register(\"period_month\", {\n              required: {\n                value: true,\n                message: \"Wajib diisi\",\n              },\n            })}\n          />\n\n          <div className=\"col-span-3 flex h-full items-end justify-end gap-2 sm:col-span-2\">\n            <Button type=\"reset\" color=\"ghost-primary\">\n              Reset\n            </Button>\n            <Button type=\"submit\" color=\"secondary\">\n              <div className=\"flex items-center gap-2\">\n                <TbSearch />\n                Cari\n              </div>\n            </Button>\n          </div>\n        </div>\n      </form>\n    </Card>\n  );\n};\n\nexport default StockCardFilter;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}