{"ast":null,"code":"import _objectSpread from\"/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import PageHeading from\"components/PageHeading\";import Card from\"components/Card\";import Toggle from\"components/Toggle\";// import FormNewborn from \"./components/FormNewborn\";\nimport FormAdult from\"./components/FormAdult\";import{useAddPatient,useEditPatient,usePatientDetail}from\"api/patient\";// import { NEWBORN_PREFIX } from \"./constants\";\nimport{useNavigate,useParams}from\"react-router-dom\";import useToaster from\"context/ToasterContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PatientForm=function PatientForm(_ref){var _addPatient$data,_editPatient$data,_data$data3,_data$data3$data;var type=_ref.type;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),defaultValue=_useState2[0],setDafaultValue=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isNewborn=_useState4[0],setNewborn=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),createdPatient=_useState6[0],setCreatedPatient=_useState6[1];var navigate=useNavigate();var _useToaster=useToaster(),openToaster=_useToaster.open;var addPatient=useAddPatient();var editPatient=useEditPatient();var _useParams=useParams(),patient_id=_useParams.patient_id;var isEdit=type===\"edit\";var _usePatientDetail=usePatientDetail({patient_id:patient_id,skip:!isEdit}),data=_usePatientDetail.data;var handleSubmit=function handleSubmit(values){setCreatedPatient(values);if(isEdit){editPatient.mutate(_objectSpread(_objectSpread({},values),{},{is_baby:Number(isNewborn),name_prefix:Number(isNewborn)}));}else{addPatient.mutate(_objectSpread(_objectSpread({},values),{},{is_baby:Number(isNewborn),name_prefix:Number(isNewborn)}));}};useEffect(function(){if(addPatient.isSuccess){navigate(\"/\",{state:{modal:{key:\"new-patient\",data:_objectSpread(_objectSpread({},createdPatient),addPatient.data.data)}}});}if(addPatient.isError){openToaster({title:\"Data pasien gagal disimpan\",message:\"Silahkan ulangi kembali setelah beberapa saat\",variant:\"error\",autoClose:false});}},[(_addPatient$data=addPatient.data)===null||_addPatient$data===void 0?void 0:_addPatient$data.data,addPatient.error,addPatient.isError,addPatient.isSuccess,createdPatient,navigate,openToaster]);useEffect(function(){if(editPatient.isSuccess){navigate(\"/pasien\",{state:{modal:{key:\"edit-patient\",data:_objectSpread(_objectSpread({},createdPatient),editPatient.data.data)}}});}if(editPatient.isError){openToaster({title:\"Data pasien gagal disimpan\",message:\"Silahkan ulangi kembali setelah beberapa saat\",variant:\"error\",autoClose:false});}},[createdPatient,(_editPatient$data=editPatient.data)===null||_editPatient$data===void 0?void 0:_editPatient$data.data,editPatient.isError,editPatient.isSuccess,navigate,openToaster]);useEffect(function(){var _data$data,_data$data$data;if(data!==null&&data!==void 0&&(_data$data=data.data)!==null&&_data$data!==void 0&&(_data$data$data=_data$data.data)!==null&&_data$data$data!==void 0&&_data$data$data.patient){var _data$data2,_data$data2$data;var patientData=data===null||data===void 0?void 0:(_data$data2=data.data)===null||_data$data2===void 0?void 0:(_data$data2$data=_data$data2.data)===null||_data$data2$data===void 0?void 0:_data$data2$data.patient;setNewborn(Boolean(patientData.is_baby));setDafaultValue(patientData);}},[data===null||data===void 0?void 0:(_data$data3=data.data)===null||_data$data3===void 0?void 0:(_data$data3$data=_data$data3.data)===null||_data$data3$data===void 0?void 0:_data$data3$data.patient]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(PageHeading,{title:isEdit?\"Ubah Data Pasien\":\"Pendaftaran Pasien Baru\",breadcrumbs:[{text:\"Pasien\",url:\"/pasien\"},isEdit?{text:\"Ubah Data Pasien\"}:{text:\"Pasien Baru\"}]}),/*#__PURE__*/_jsxs(Card,{className:\"max-w-screen-lg rounded-2xl border-none p-6 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-span-2 border-b pb-4\",children:/*#__PURE__*/_jsx(Toggle,{value:isNewborn,onSwitch:setNewborn,className:\"order-2 md:order-1\",children:\"Pasien adalah bayi baru lahir\"})}),(isEdit&&defaultValue||!isEdit)&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(FormAdult,{isBaby:isNewborn,defaultValue:defaultValue,onSubmit:handleSubmit})})]})]});};export default PatientForm;","map":{"version":3,"names":["useEffect","useState","PageHeading","Card","Toggle","FormAdult","useAddPatient","useEditPatient","usePatientDetail","useNavigate","useParams","useToaster","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","PatientForm","_ref","_addPatient$data","_editPatient$data","_data$data3","_data$data3$data","type","_useState","_useState2","_slicedToArray","defaultValue","setDafaultValue","_useState3","_useState4","isNewborn","setNewborn","_useState5","undefined","_useState6","createdPatient","setCreatedPatient","navigate","_useToaster","openToaster","open","addPatient","editPatient","_useParams","patient_id","isEdit","_usePatientDetail","skip","data","handleSubmit","values","mutate","_objectSpread","is_baby","Number","name_prefix","isSuccess","state","modal","key","isError","title","message","variant","autoClose","error","_data$data","_data$data$data","patient","_data$data2","_data$data2$data","patientData","Boolean","children","breadcrumbs","text","url","className","value","onSwitch","isBaby","onSubmit"],"sources":["/Users/risky.setiyawan/Documents/Proj/mitramedis-frontend/src/pages/PatientForm/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport PageHeading from \"components/PageHeading\";\nimport Card from \"components/Card\";\nimport Toggle from \"components/Toggle\";\n// import FormNewborn from \"./components/FormNewborn\";\nimport FormAdult from \"./components/FormAdult\";\nimport { PatientType } from \"types/patient\";\nimport { useAddPatient, useEditPatient, usePatientDetail } from \"api/patient\";\n// import { NEWBORN_PREFIX } from \"./constants\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport useToaster from \"context/ToasterContext\";\n\ninterface PatientFormProps {\n  type: \"new\" | \"edit\";\n}\n\nconst PatientForm = ({ type }: PatientFormProps) => {\n  const [defaultValue, setDafaultValue] = useState(null);\n  const [isNewborn, setNewborn] = useState(false);\n  const [createdPatient, setCreatedPatient] = useState<\n    { patient_name: string } | undefined\n  >(undefined);\n  const navigate = useNavigate();\n  const { open: openToaster } = useToaster();\n  const addPatient = useAddPatient();\n  const editPatient = useEditPatient();\n  const { patient_id } = useParams();\n\n  const isEdit = type === \"edit\";\n\n  const { data } = usePatientDetail({\n    patient_id,\n    skip: !isEdit,\n  });\n\n  const handleSubmit = (values: PatientType) => {\n    setCreatedPatient(values);\n\n    if (isEdit) {\n      editPatient.mutate({\n        ...values,\n        is_baby: Number(isNewborn),\n        name_prefix: Number(isNewborn),\n      });\n    } else {\n      addPatient.mutate({\n        ...values,\n        is_baby: Number(isNewborn),\n        name_prefix: Number(isNewborn),\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (addPatient.isSuccess) {\n      navigate(\"/\", {\n        state: {\n          modal: {\n            key: \"new-patient\",\n            data: {\n              ...createdPatient,\n              ...addPatient.data.data,\n            },\n          },\n        },\n      });\n    }\n\n    if (addPatient.isError) {\n      openToaster({\n        title: \"Data pasien gagal disimpan\",\n        message: \"Silahkan ulangi kembali setelah beberapa saat\",\n        variant: \"error\",\n        autoClose: false,\n      });\n    }\n  }, [\n    addPatient.data?.data,\n    addPatient.error,\n    addPatient.isError,\n    addPatient.isSuccess,\n    createdPatient,\n    navigate,\n    openToaster,\n  ]);\n\n  useEffect(() => {\n    if (editPatient.isSuccess) {\n      navigate(\"/pasien\", {\n        state: {\n          modal: {\n            key: \"edit-patient\",\n            data: {\n              ...createdPatient,\n              ...editPatient.data.data,\n            },\n          },\n        },\n      });\n    }\n\n    if (editPatient.isError) {\n      openToaster({\n        title: \"Data pasien gagal disimpan\",\n        message: \"Silahkan ulangi kembali setelah beberapa saat\",\n        variant: \"error\",\n        autoClose: false,\n      });\n    }\n  }, [\n    createdPatient,\n    editPatient.data?.data,\n    editPatient.isError,\n    editPatient.isSuccess,\n    navigate,\n    openToaster,\n  ]);\n\n  useEffect(() => {\n    if (data?.data?.data?.patient) {\n      const patientData = data?.data?.data?.patient;\n      setNewborn(Boolean(patientData.is_baby));\n      setDafaultValue(patientData);\n    }\n  }, [data?.data?.data?.patient]);\n\n  return (\n    <div>\n      <PageHeading\n        title={isEdit ? \"Ubah Data Pasien\" : \"Pendaftaran Pasien Baru\"}\n        breadcrumbs={[\n          { text: \"Pasien\", url: \"/pasien\" },\n          isEdit ? { text: \"Ubah Data Pasien\" } : { text: \"Pasien Baru\" },\n        ]}\n      />\n      <Card className=\"max-w-screen-lg rounded-2xl border-none p-6 shadow-sm\">\n        <div className=\"col-span-2 border-b pb-4\">\n          <Toggle\n            value={isNewborn}\n            onSwitch={setNewborn}\n            className=\"order-2 md:order-1\"\n          >\n            Pasien adalah bayi baru lahir\n          </Toggle>\n        </div>\n        {((isEdit && defaultValue) || !isEdit) && (\n          <>\n            {/* {isNewborn && (\n              <FormNewborn\n                namePrefix={NEWBORN_PREFIX}\n                defaultValue={defaultValue}\n                onSubmit={handleSubmit}\n              />\n            )} */}\n            {/* {!isNewborn && ( */}\n            <FormAdult\n              isBaby={isNewborn}\n              defaultValue={defaultValue}\n              onSubmit={handleSubmit}\n            />\n            {/* )} */}\n          </>\n        )}\n      </Card>\n    </div>\n  );\n};\n\nexport default PatientForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}